<?xml version="1.0"?>
<CONFIGURATION service="farm">
	<!-- 
		Farm configuration
		. Member-type must be one of :
		  NONE      - implies the platform instance will not join the farm
		  MEMBER    - implies the platform instance will join the farm as a client
		  SECONDARY - implies the platform instance will join the farm as a client and as a failover master
		  MASTER    - implies the platform instance will join the farm as a master
		  
		  There should be one master in a farm and at least one secondary for redundancy.
		  
		. <master> configures the MASTER listening ip. This is the listening IP & port 
		  used by the MASTER member to accept MEMBER connections and used by MEMBERs to
		  establish a connection to the MASTER.
		  
		. <member> configures the SECONDARY listening ip. These parameters are ignored
		  by MASTER and MEMBER platforms.
		  
		. <ping-period> is the base heart beat time to detect failures in the farm.
	-->
<% if taskmanager_cluster.at(0) == ipaddress -%>
	<farm member-type="MASTER">
<% else -%>
	<farm member-type="SECONDARY">
<% end -%>
<% taskmanager_cluster.each do |ip| -%>
<% if taskmanager_cluster.at(0) == ip -%>
		<master ip="<%= ip %>" port="<%= l_port_farm %>"/>
<% else -%>
		<member ip="<%= ip %>" port="<%= l_port_farm %>"/>
<% end -%>
<% end -%>
<% pushserver_cluster.each do |ip| -%>
		<member ip="<%= ip %>" port="<%= l_port_farm %>"/>
<% end -%>
		<ping-period unit="SECONDS">10</ping-period>
	</farm>
</CONFIGURATION>
