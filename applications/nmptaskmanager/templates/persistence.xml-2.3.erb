<?xml version="1.0"?>
<CONFIGURATION service="persistence">
	<persistence>
		<datasources>
			<datasource jndi-name="MySQLPrimary" class-name="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
				<property name="user" value="<%= sch_sql_col_tbl.at(0) %>" />
				<property name="password" value="<%= sch_pwd %>" />
				<property name="socketTimeout" value="5000" />
				<property name="url" value="jdbc:mysql://<%= db_master %>:3306/<%= sch_sql_col_tbl.at(0) %>" />
			</datasource>
			<datasource jndi-name="MySQLSecondary" class-name="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
				<property name="user" value="<%= sch_sql_col_tbl.at(0) %>" />
				<property name="password" value="<%= sch_pwd %>" />
				<property name="socketTimeout" value="5000" />
<% if db_slave != '' -%>
				<property name="url" value="jdbc:mysql://<%= db_slave %>:3306/<%= sch_sql_col_tbl.at(0) %>" />
<% else -%>
				<property name="url" value="jdbc:mysql://<%= db_master %>:3306/<%= sch_sql_col_tbl.at(0) %>" />
<% end -%>
			</datasource>
			<non-transacted-pool jndi-name="MySQLPoolPrimary" datasource-ref="MySQLPrimary" min="1" max="50">
				<property name="testQuery" value="SELECT 1 FROM DUAL" />
				<property name="maxWait" value="10" />
			</non-transacted-pool>
			<non-transacted-pool jndi-name="MySQLPoolSecondary" datasource-ref="MySQLSecondary" min="1" max="50">
				<property name="testQuery" value="SELECT 1 FROM DUAL" />
				<property name="maxWait" value="10" />
			</non-transacted-pool>
			<failover-pool jndi-name="MySqlFailOverPoolDS">
				<datasource-ref jndi-name="MySQLPoolPrimary" />
				<datasource-ref jndi-name="MySQLPoolSecondary" />
			</failover-pool>
		</datasources>
	</persistence>
</CONFIGURATION>
