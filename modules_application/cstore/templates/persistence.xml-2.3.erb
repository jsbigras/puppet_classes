<?xml version="1.0"?>
<CONFIGURATION service="persistence">
	<persistence>
		<datasources>
			<datasource jndi-name="MyriadStoreMysqlPrimaryDataSource" class-name="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
				<property name="user" value="<%= sch_sql_col_tbl.at(0) %>" />
				<property name="password" value="<%= sch_pwd %>" />
				<property name="url" value="jdbc:mysql://<%= db_master %>:3306/<%= sch_sql_col_tbl.at(0) %>?useUnicode=true&amp;characterEncoding=UTF-8&amp;useLegacyDatetimeCode=false" />
				<property name="connectTimeout" value="10000" />
				<property name="socketTimeout" value="10000" />
			</datasource>
			<datasource jndi-name="MyriadStoreMysqlSecondaryDataSource" class-name="com.mysql.jdbc.jdbc2.optional.MysqlConnectionPoolDataSource">
				<property name="user" value="<%= sch_sql_col_tbl.at(0) %>" />
				<property name="password" value="<%= sch_pwd %>" />
<% if db_slave != '' -%>
				<property name="url" value="jdbc:mysql://<%= db_slave %>:3306/<%= sch_sql_col_tbl.at(0) %>?useUnicode=true&amp;characterEncoding=UTF-8&amp;useLegacyDatetimeCode=false" />
<% else -%>
				<property name="url" value="jdbc:mysql://<%= db_master %>:3306/<%= sch_sql_col_tbl.at(0) %>?useUnicode=true&amp;characterEncoding=UTF-8&amp;useLegacyDatetimeCode=false" />
<% end -%>
				<property name="connectTimeout" value="10000" />
				<property name="socketTimeout" value="10000" />
			</datasource>
			<non-transacted-pool jndi-name="MyriadStorePrimaryDsPool" datasource-ref="MyriadStoreMysqlPrimaryDataSource" min="10" max="100">
				<property name="testQuery" value="SELECT 1 FROM DUAL" />
				<property name="maxIdle" value="120" />
			</non-transacted-pool>
			<non-transacted-pool jndi-name="MyriadStoreSecondaryDsPool" datasource-ref="MyriadStoreMysqlSecondaryDataSource" min="10" max="100">
				<property name="testQuery" value="SELECT 1 FROM DUAL" />
				<property name="maxIdle" value="120" />
			</non-transacted-pool>
			<failover-pool jndi-name="MyriadStoreDataSourceFailOverPoolDataSource">
				<datasource-ref jndi-name="MyriadStorePrimaryDsPool" />
				<datasource-ref jndi-name="MyriadStoreSecondaryDsPool" />
			</failover-pool>
			<sharded-pool jndi-name="MyriadStoreShardedDataSource">
				<shard index-range="0-255" datasource-ref="MyriadStoreDataSourceFailOverPoolDataSource" />
			</sharded-pool>
		</datasources>
	</persistence>
</CONFIGURATION>
